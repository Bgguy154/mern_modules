<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Study Group Scheduler</title>

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Poppins", sans-serif;
      }

      body {
        background: #f5f6fa;
        display: flex;
        min-height: 100vh;
      }

      /* Sidebar */
      .sidebar {
        width: 260px;
        background: #2d3436;
        color: white;
        padding: 20px;
        overflow-y: auto;
      }

      .sidebar h2 {
        margin-bottom: 15px;
      }

      .user-list {
        margin-top: 20px;
      }

      .user-card {
        background: #636e72;
        padding: 10px;
        border-radius: 8px;
        margin-bottom: 10px;
        color: #fff;
      }

      /* Main Area */
      .main {
        flex: 1;
        padding: 25px;
        overflow-y: auto;
      }

      .section {
        background: white;
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 25px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.08);
      }

      h2 {
        margin-bottom: 15px;
      }

      /* Forms */
      form input,
      form select {
        width: 100%;
        padding: 10px;
        margin: 8px 0 15px;
        border-radius: 6px;
        border: 1px solid #ccc;
      }

      form button {
        background: #0984e3;
        border: none;
        padding: 10px 14px;
        color: white;
        border-radius: 6px;
        cursor: pointer;
        width: 100%;
        font-size: 16px;
      }

      form button:hover {
        background: #0764b3;
      }

      /* Table */
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
      }

      th,
      td {
        padding: 12px;
        border-bottom: 1px solid #ddd;
      }

      th {
        background: #dfe6e9;
      }

      tr:hover {
        background: #f1f2f6;
      }

      .join-btn {
        background: #00b894;
        padding: 7px 15px;
        color: white;
        font-size: 14px;
        border-radius: 5px;
        cursor: pointer;
        border: none;
      }

      .join-btn:disabled {
        background: #b2bec3;
        cursor: not-allowed;
      }

      /* Expandable row */
      .session-details {
        display: none;
        background: #f8f9fa;
        padding: 12px;
        border-radius: 8px;
        margin-bottom: 10px;
      }

      .session-details p {
        margin: 6px 0;
      }

      /* Filters */
      .filters {
        display: flex;
        gap: 20px;
        margin-top: 10px;
      }

      .filters input,
      .filters select {
        flex: 1;
        padding: 10px;
      }

      /* Dashboard counters */
      .dashboard {
        display: flex;
        gap: 20px;
      }

      .box {
        flex: 1;
        text-align: center;
        background: #fff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.08);
      }

      .box h3 {
        font-size: 24px;
        margin-bottom: 5px;
      }

      .box p {
        color: #777;
      }
    </style>
  </head>
  <body>
    <!-- Sidebar: User Registration -->
    <div class="sidebar">
      <h2>Users</h2>

      <form id="userForm">
        <input type="text" id="userName" placeholder="Your Name" required />
        <input type="email" id="userEmail" placeholder="Your Email" required />
        <input
          type="text"
          id="userSubjects"
          placeholder="Subjects (comma separated)"
          required
        />
        <button type="submit" id="register">Register User</button>
      </form>

      <div class="user-list" id="userList"></div>
    </div>

    <!-- Main Content -->
    <div class="main">
      <!-- Dashboard -->
      <div class="dashboard">
        <div class="box">
          <h3 id="totalUsers">0</h3>
          <p>Total Users</p>
        </div>
        <div class="box">
          <h3 id="totalSessions">0</h3>
          <p>Total Study Sessions</p>
        </div>
        <div class="box">
          <h3 id="totalParticipants">0</h3>
          <p>Total Participants</p>
        </div>
      </div>

      <!-- Create Study Session -->
      <div class="section">
        <h2>Create Study Session</h2>

        <form id="sessionForm">
          <input
            type="text"
            id="sessionSubject"
            placeholder="Subject"
            required
          />
          <input type="date" id="sessionDate" required />
          <input type="time" id="sessionTime" required />
          <input
            type="number"
            id="sessionMax"
            placeholder="Max Participants"
            required
            min="1"
          />
          <input
            type="text"
            id="createdBy"
            placeholder="Created By (User Name)"
            required
          />

          <button type="submit" id="createSession">Create Session</button>
        </form>
      </div>

      <!-- Filters -->
      <div class="section">
        <h2>Search & Filters</h2>

        <div class="filters">
          <input
            type="text"
            id="searchInput"
            placeholder="Search by subject..."
          />
          <select id="filterSubject">
            <option value="all">All Subjects</option>
          </select>
          <select id="sortByDate">
            <option value="asc">Sort By Date (Asc)</option>
            <option value="desc">Sort By Date (Desc)</option>
          </select>
        </div>
      </div>

      <!-- Sessions Table -->
      <div class="section">
        <h2>Study Sessions</h2>

        <table
          id="table"
          style="border-spacing: 0 12px; border-collapse: separate"
        >
          <thead>
            <tr>
              <th>Subject</th>
              <th>Date</th>
              <th>Time</th>
              <th>Participants</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="sessionTable">
            <tr style="width: 100vw;">
              <td>History</td>
              <td>13 Dec</td>
              <td>4 pm</td>
              <td>7</td>
              <td>
                <button
                  style="
                    background-color: blue;
                    color: white;
                    border-radius: 10px;
                    width: 70px;
                    margin-left:300px
                  "
                >
                  Join
                </button>
              </td>
            </tr>
            <tr>
              <td>Geography</td>
              <td>23 Dec</td>
              <td>7 pm</td>
              <td>9</td>
              <td>
                <button
                  style="
                    background-color: blue;
                    color: white;
                    border-radius: 10px;
                    width: 70px;
                    margin-left:300px
                  "
                >
                  Join
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Expanded session details area (JS will toggle visibility) -->
      <div id="sessionDetailsContainer"></div>
    </div>
    <script>
      // ------------------------------
      // USER REGISTRATION SELECTORS
      // ------------------------------

      const userForm = document.getElementById("userForm");
      const userNameInput = document.getElementById("userName");
      const userEmailInput = document.getElementById("userEmail");
      const userSubjectsInput = document.getElementById("userSubjects");
      const userListContainer = document.getElementById("userList");
      const registerBtn = document.getElementById("register");
      const sidebar = document.querySelector(".sidebar");

      const totalUsersCounter = document.getElementById("totalUsers");
      const totalParticipantsCounter =
        document.getElementById("totalParticipants");

      class User {
        constructor(name, email, subject) {
          this.name = name;
          this.email = email;
          this.subject = subject;
        }
      }
      let users = [];

      registerBtn.addEventListener("click", (e) => {
        e.preventDefault();

        // Save user data correctly ONLY when clicking register
        const name = userNameInput.value.trim();
        const email = userEmailInput.value.trim();
        const sub = userSubjectsInput.value.trim();

        if (!name || !email || !sub) {
          alert("Enter all details carefully");
          return;
        }

        // Store into localStorage
        localStorage.setItem("name", name);
        localStorage.setItem("email", email);
        localStorage.setItem("sub", sub);

        // Update counter properly
        let currentCount = Number(totalParticipantsCounter.textContent);
        let userCount = Number(totalUsersCounter.textContent);
        totalParticipantsCounter.textContent = currentCount + 1;
        totalUsersCounter.textContent = userCount + 1;

        let u1 = new User(name, email, sub);
        users.push(u1);
        addtoSideBar(u1);

        userNameInput.value = "";
        userEmailInput.value = "";
        userSubjectsInput.value = "";
      });

      function addtoSideBar(user) {
        let user1 = document.createElement("div");
        user1.innerHTML = `
    <p><strong>${user.name}</strong></p>
    `;
        userListContainer.appendChild(user1);
      }

      // ------------------------------
      // STUDY SESSION FORM SELECTORS
      // ------------------------------

      const sessionForm = document.getElementById("sessionForm");
      const sessionSubjectInput = document.getElementById("sessionSubject");
      const sessionDateInput = document.getElementById("sessionDate");
      const sessionTimeInput = document.getElementById("sessionTime");
      const sessionMaxInput = document.getElementById("sessionMax");
      const createdByInput = document.getElementById("createdBy");
      const createSessionBtn = document.getElementById("createSession");

      const totalSessionsCounter = document.getElementById("totalSessions");

      class studySessions {
        #participants = [...users];
        constructor(sub, date, time, maxParticipants, createdBy) {
          this.sub = sub;
          this.date = date;
          this.time = time;
          this.maxParticipants = maxParticipants;
          this.createdBy = createdBy;
        }
        addParticipants(username) {
          if (participants.length >= maxParticipants) {
            alert("Maximum Participation of the session reached");
            return;
          }
          addtoSideBar(username);
        }
        removeParticipants(username) {
          if (!participants.includes(username)) {
            alert("this is no valid username ");
            return;
          }
          users.filter((ele) => ele.name != username);
        }

        //     getSessionInfo(){
        //         if()
        //     }
      }

      createSessionBtn.addEventListener("click", (e) => {
        e.preventDefault();
        const sub = sessionSubjectInput.value.trim();
        const date = sessionDateInput.value.trim();
        const time = sessionTimeInput.value.trim();
        const maxParticipants = sessionMaxInput.value.trim();
        const sessions = [sub,date,time,maxParticipants];
        addSession(sessions);
        sub.value = "";
        date.value = "";
        time.value = "";
        maxParticipants.value = "";
      });

      function addSession(session) {
        const table = document.querySelector("#sessionTable");
        const sessionInfo = document.createElement("tr");
        sessionInfo.innerHTML = `
    <td>${session[0]}</td>
    <td>${session[1]}</td>
    <td>${session[2]}</td>
    <td>${session[3]}</td>
    <td><button style="
                    background-color: blue;
                    color: white;
                    border-radius: 10px;
                    width: 70px;
                    margin-left:300px
                  ">Join</button></td>
  `;
        table.appendChild(sessionInfo);
      }

      // ------------------------------
      // FILTERS & SEARCH SELECTORS
      // ------------------------------

      const searchInput = document.getElementById("searchInput");
      const filterSubjectSelect = document.getElementById("filterSubject");
      const sortByDateSelect = document.getElementById("sortByDate");

      // ------------------------------
      // SESSION TABLE SELECTORS
      // ------------------------------


      // ------------------------------
      // EXPANDED DETAILS SECTION
      // ------------------------------

      const sessionDetailsContainer = document.getElementById(
        "sessionDetailsContainer"
      );

      // ------------------------------
      // REUSABLE SELECTORS (If needed later)
      // ------------------------------

      // Use for event delegation
      const mainContainer = document.querySelector(".main");

      // All session rows (dynamic; use inside functions)
      function getAllSessionRows() {
        return document.querySelectorAll(".session-row");
      }

      // All user cards (dynamic)
      function getAllUserCards() {
        return document.querySelectorAll(".user-card");
      }
    </script>
  </body>
</html>
